<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Realest - Bangalore MVP</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        body { font-family: 'Inter', sans-serif; }
        .leaflet-control-zoom { display: block !important; }
        .leaflet-control-attribution { display: none; }
        .custom-map-pin {
            width: 32px!important; height: 32px!important;
            border-radius: 50% 50% 50% 0; transform: rotate(-45deg);
            border: 2px solid white; box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            transition: all 0.2s ease-in-out;
        }
        .custom-map-pin::after {
            content: ''; position: absolute; width: 12px; height: 12px;
            background-color: white; border-radius: 50%;
            top: 50%; left: 50%; transform: translate(-50%, -50%);
        }
        .custom-map-pin.pin-rent { background-color: #4f46e5; }
        .custom-map-pin.pin-sale { background-color: #db2777; }
        .custom-map-pin.highlighted { transform: rotate(-45deg) scale(1.3); z-index: 1000 !important; }

        .property-card.highlighted.highlight-rent { background-color: #e0e7ff; }
        .property-card.highlighted.highlight-sale { background-color: #fce7f3; }
        
        #details-panel { transition: transform 0.3s ease-in-out; }
    </style>
</head>
<body class="bg-gray-100 text-gray-800 h-screen overflow-hidden flex flex-col">

    <!-- Header -->
    <header class="flex-shrink-0 flex justify-between items-center p-3 bg-white border-b border-gray-200 z-30 shadow-sm">
        <div class="flex items-center space-x-3">
            <svg class="w-8 h-8 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"></path></svg>
            <h1 class="text-2xl font-bold text-indigo-600">Realest.</h1>
        </div>
        <div class="flex-grow max-w-lg mx-4">
             <input id="search-input" type="text" placeholder="Search for a location..." class="w-full px-4 py-2 text-sm border border-gray-300 rounded-full focus:ring-indigo-500 focus:border-indigo-500 shadow-inner">
        </div>
        <button class="px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-full hover:bg-indigo-700">Sign In</button>
    </header>

    <!-- Main Content -->
    <main class="flex-grow relative overflow-hidden">
        <div class="w-full h-full" id="map"></div>

        <!-- Left Floating Panel (List) -->
        <div id="list-panel" class="absolute top-4 left-4 z-10 w-full max-w-md h-[calc(100%-2rem)] bg-white rounded-lg shadow-xl flex flex-col">
             <!-- List view will be rendered here by JS -->
        </div>

        <!-- Right Sliding Panel (Details) -->
        <div id="details-panel" class="absolute top-0 left-0 z-20 w-full max-w-md h-full bg-white shadow-2xl transform -translate-x-full">
            <!-- Details content will be injected here by JS -->
        </div>
    </main>
    
    <script>
        // --- MOCK DATA ---
        // Boundaries are now accurately traced to match the building shape in the image
        const mockProperties = [
            { id: 1, transactionType: 'rent', title: 'Modern L-Shape Apartment Complex', location: 'Koramangala 4th Block', price: 55000, type: '2 BHK Apartment', area: 1350, furnishing: 'Semi-Furnished', image: 'https://images.unsplash.com/photo-1574362848149-1b27df883791?q=80&w=2070&auto=format&fit=crop', coords: [12.9324, 77.6382], boundary: [[12.9328, 77.6380],[12.9326, 77.6385],[12.9322, 77.6383],[12.9320, 77.6385],[12.9318, 77.6382],[12.9322, 77.6378]], trustStack: { score: 8.5, commute: { office: 'EcoWorld', time: '35-50 min' }, utilities: { water: 'Cauvery', power: 'Inverter (Lights, WiFi)', internet: 'ACT 1Gbps' }, legal: { khata: 'A Khata', bbmp: 'Approved' }, liveability: { walk: 9, safety: 8, noise: 6, connectivity: 9 } } },
            { id: 2, transactionType: 'sale', title: 'Luxury Villa with Garden', location: 'Indiranagar', price: 45000000, type: '4 BHK Villa', area: 3200, furnishing: 'Fully-Furnished', image: 'https://images.unsplash.com/photo-1613490493576-7fde63acd811?q=80&w=2071&auto=format&fit=crop', coords: [12.9784, 77.6408], boundary: [[12.9787, 77.6405],[12.9786, 77.6412],[12.9781, 77.6411],[12.9782, 77.6404]], trustStack: { score: 9.2, commute: { office: 'MG Road', time: '15-25 min' }, utilities: { water: 'Cauvery & Borewell', power: 'Full Generator', internet: 'Multiple Providers' }, legal: { khata: 'A Khata', bbmp: 'Approved' }, liveability: { walk: 10, safety: 9, noise: 7, connectivity: 10 } } },
            { id: 3, transactionType: 'rent', title: 'Compact Apartment Building', location: 'HSR Layout', price: 28000, type: '1 BHK Studio', area: 750, furnishing: 'Fully-Furnished', image: 'https://images.unsplash.com/photo-1512917774080-9991f1c4c750?q=80&w=2070&auto=format&fit=crop', coords: [12.9121, 77.6446], boundary: [[12.9123, 77.6444],[12.9122, 77.6449],[12.9118, 77.6447],[12.9119, 77.6442]], trustStack: { score: 6.8, commute: { office: 'EcoWorld', time: '20-35 min' }, utilities: { water: 'Tanker-Dependent', power: 'None', internet: 'JioFiber 500Mbps' }, legal: { khata: 'A Khata', bbmp: 'Approved' }, liveability: { walk: 7, safety: 7, noise: 8, connectivity: 6 } } },
        ];

        // --- DOM ELEMENTS & APP STATE ---
        const listPanel = document.getElementById('list-panel');
        const detailsPanel = document.getElementById('details-panel');
        let map, chartInstance;
        let markers = {}, polygons = {};
        let currentFilter = 'all';

        // --- MAP INITIALIZATION ---
        function initMap() {
            map = L.map('map', { zoomControl: false }).setView([12.935, 77.625], 13);
            L.control.zoom({ position: 'bottomright' }).addTo(map);
            L.tileLayer('https://{s}.basemaps.cartocdn.com/rastertiles/voyager_labels_under/{z}/{x}/{y}{r}.png').addTo(map);
            mockProperties.forEach(prop => {
                const pinClass = prop.transactionType === 'sale' ? 'pin-sale' : 'pin-rent';
                const icon = L.divIcon({ className: `custom-map-pin ${pinClass}`, iconSize: [32, 32] });
                const marker = L.marker(prop.coords, { icon: icon }).addTo(map);
                marker.on('click', () => renderDetailsView(prop.id));
                markers[prop.id] = marker;
                const polygon = L.polygon(prop.boundary, { weight: 1, dashArray: '5, 5', fillOpacity: 0.1, color: '#3388ff' }).addTo(map);
                polygon.on('click', () => renderDetailsView(prop.id));
                polygons[prop.id] = polygon;
            });
        }
        
        // --- UI RENDERING & LOGIC ---
        function formatPrice(price, type) {
            if (type === 'rent') return `‚Çπ${price.toLocaleString('en-IN')}`;
            if (price >= 10000000) return `‚Çπ${(price / 10000000).toFixed(2)} Cr`;
            return `‚Çπ${(price / 100000).toFixed(2)} L`;
        }

        function highlightProperty(propertyId) {
            document.querySelectorAll('.property-card').forEach(el => el.classList.remove('highlighted', 'highlight-rent', 'highlight-sale'));
            if (propertyId) {
                const prop = mockProperties.find(p => p.id === propertyId);
                if (prop) {
                    const card = document.querySelector(`.property-card[data-id='${propertyId}']`);
                    if (card) {
                        card.classList.add('highlighted', `highlight-${prop.transactionType}`);
                        card.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                    }
                }
            }
            for (const id in markers) {
                const markerElement = markers[id].getElement();
                const polygon = polygons[id];
                const prop = mockProperties.find(p => p.id == id);
                if (id == propertyId) {
                    markerElement.classList.add('highlighted');
                    markers[id].setZIndexOffset(1000);
                    const color = prop.transactionType === 'sale' ? '#db2777' : '#4f46e5';
                    polygon.setStyle({ color: color, weight: 4, dashArray: '', fillOpacity: 0.3 });
                    polygon.bringToFront();
                } else {
                    markerElement.classList.remove('highlighted');
                    markers[id].setZIndexOffset(0);
                    polygon.setStyle({ weight: 1, dashArray: '5, 5', fillOpacity: 0.1, color: '#3388ff' });
                }
            }
        }

        function renderListView() {
            listPanel.innerHTML = `
                <div class="p-4 flex-shrink-0 border-b">
                    <h2 class="text-xl font-bold">Verified Properties</h2>
                    <div id="filter-buttons" class="mt-2 flex space-x-2">
                        <button class="filter-btn active px-3 py-1 text-sm font-semibold rounded-full bg-indigo-100 text-indigo-800" data-filter="all">All</button>
                        <button class="filter-btn px-3 py-1 text-sm font-semibold rounded-full bg-gray-100 text-gray-700" data-filter="sale">For Sale</button>
                        <button class="filter-btn px-3 py-1 text-sm font-semibold rounded-full bg-gray-100 text-gray-700" data-filter="rent">For Rent</button>
                    </div>
                </div>
                <div class="flex-grow overflow-y-auto p-2 space-y-2" id="list-container"></div>`;
            
            applyFilter();

            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.addEventListener('click', e => {
                    currentFilter = e.target.dataset.filter;
                    applyFilter();
                });
            });
        }
        
        function applyFilter() {
            const filteredProperties = currentFilter === 'all' ? mockProperties : mockProperties.filter(p => p.transactionType === currentFilter);
            
            Object.values(markers).forEach(marker => map.removeLayer(marker));
            Object.values(polygons).forEach(polygon => map.removeLayer(polygon));
            
            filteredProperties.forEach(prop => {
                if (markers[prop.id]) markers[prop.id].addTo(map);
                if (polygons[prop.id]) polygons[prop.id].addTo(map);
            });

            const container = document.getElementById('list-container');
            container.innerHTML = ''; // Clear previous list
            filteredProperties.forEach(prop => {
                const card = document.createElement('div');
                card.className = 'property-card p-3 border-b last:border-b-0 rounded-lg cursor-pointer transition-colors duration-200 hover:bg-gray-50';
                card.dataset.id = prop.id;
                const priceString = prop.transactionType === 'rent' ? `${formatPrice(prop.price, 'rent')}<span class="text-xs text-gray-500">/month</span>` : formatPrice(prop.price, 'sale');
                const priceColor = prop.transactionType === 'sale' ? 'text-pink-600' : 'text-indigo-600';

                card.innerHTML = `<div class="flex space-x-3"><img src="${prop.image}" alt="${prop.title}" class="w-24 h-24 object-cover rounded-md flex-shrink-0"><div class="flex-1"><p class="text-xs font-semibold ${priceColor} uppercase">${prop.transactionType === 'sale' ? 'FOR SALE' : 'FOR RENT'}</p><h3 class="font-bold text-md leading-tight">${prop.title}</h3><p class="text-xs text-gray-600">${prop.location}</p><div class="flex items-center justify-between mt-1"><p class="font-bold text-lg ${priceColor}">${priceString}</p><div class="flex items-center text-green-600 text-xs font-semibold"><svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>Verified</div></div></div></div>`;
                card.addEventListener('mouseover', () => highlightProperty(prop.id));
                card.addEventListener('click', () => renderDetailsView(prop.id));
                container.appendChild(card);
            });

            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('bg-indigo-100', 'text-indigo-800');
                btn.classList.add('bg-gray-100', 'text-gray-700');
                if (btn.dataset.filter === currentFilter) {
                    btn.classList.add('bg-indigo-100', 'text-indigo-800');
                    btn.classList.remove('bg-gray-100', 'text-gray-700');
                }
            });
        }

        function renderDetailsView(propertyId) {
            const prop = mockProperties.find(p => p.id === propertyId);
            if (!prop) return;

            const priceLabel = prop.transactionType === 'rent' ? 'Monthly Rent' : 'Price';
            const priceString = formatPrice(prop.price, prop.transactionType);
            const typeColor = prop.transactionType === 'sale' ? 'text-pink-600' : 'text-indigo-600';

            detailsPanel.innerHTML = `
                <div class="h-full flex flex-col">
                    <div class="flex-shrink-0 relative">
                        <img src="${prop.image}" class="w-full h-56 object-cover">
                        <button id="back-to-list" class="absolute top-4 left-4 text-white bg-black bg-opacity-50 hover:bg-opacity-75 p-2 rounded-full z-10">
                             <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg>
                        </button>
                    </div>
                    <div class="flex-grow overflow-y-auto p-4 md:p-6 space-y-6">
                        <div>
                             <p class="text-sm font-semibold uppercase ${typeColor}">${prop.type}</p>
                             <h3 class="text-2xl font-bold mt-1">${prop.title}</h3>
                             <p class="text-gray-600 mt-1">${prop.location}</p>
                        </div>
                        <div class="grid grid-cols-3 gap-4 text-center bg-gray-50 p-3 rounded-lg">
                            <div><p class="text-xs text-gray-500">${priceLabel}</p><p class="font-bold text-lg">${priceString}${prop.transactionType === 'rent' ? '/mo' : ''}</p></div>
                            <div><p class="text-xs text-gray-500">Area</p><p class="font-bold text-lg">${prop.area} sq.ft.</p></div>
                            <div><p class="text-xs text-gray-500">Furnishing</p><p class="font-bold text-lg">${prop.furnishing}</p></div>
                        </div>
                        <div class="border-t pt-4">
                            <h4 class="font-bold text-lg mb-3">Realest Trust Report</h4>
                            <div class="space-y-4">
                                <div class="flex items-start"><div class="flex-shrink-0 w-8 text-center text-xl">üìÑ</div><div><span class="font-semibold">Legal Status:</span> Verified ${prop.trustStack.legal.khata} & BBMP Approved Plan.</div></div>
                                <div class="flex items-start"><div class="flex-shrink-0 w-8 text-center text-xl">üíß</div><div><span class="font-semibold">Water:</span> ${prop.trustStack.utilities.water}</div></div>
                                <div class="flex items-start"><div class="flex-shrink-0 w-8 text-center text-xl">‚ö°Ô∏è</div><div><span class="font-semibold">Power Backup:</span> ${prop.trustStack.utilities.power}</div></div>
                                <div class="flex items-start"><div class="flex-shrink-0 w-8 text-center text-xl">üöó</div><div><span class="font-semibold">Commute to ${prop.trustStack.commute.office}:</span> ${prop.trustStack.commute.time} (Peak)</div></div>
                                <div>
                                    <h5 class="font-semibold mb-2 text-center">Liveability Index</h5>
                                    <canvas id="liveabilityChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>`;
            
            detailsPanel.classList.remove('-translate-x-full');
            document.getElementById('back-to-list').addEventListener('click', () => {
                detailsPanel.classList.add('-translate-x-full');
                highlightProperty(null);
            });

            if (chartInstance) chartInstance.destroy();
            const ctx = document.getElementById('liveabilityChart').getContext('2d');
            const data = prop.trustStack.liveability;
            chartInstance = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: ['Walkability', 'Safety', 'Noise', 'Connectivity'],
                    datasets: [{
                        label: 'Score',
                        data: [data.walk, data.safety, data.noise, data.connectivity],
                        backgroundColor: 'rgba(79, 70, 229, 0.2)',
                        borderColor: 'rgba(79, 70, 229, 1)',
                        borderWidth: 2
                    }]
                },
                options: { scales: { r: { beginAtZero: true, max: 10, pointLabels: { font: { size: 12 } } } }, plugins: { legend: { display: false } } }
            });

            highlightProperty(propertyId);
            map.fitBounds(polygons[prop.id].getBounds().pad(0.1));
        }

        // --- INITIALIZATION ---
        document.addEventListener('DOMContentLoaded', () => {
            initMap();
            renderListView();
        });
    </script>
</body>
</html>

